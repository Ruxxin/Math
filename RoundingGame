<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Financial Auditor: Rounding Challenge</title>
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #27ae60;
            --error: #e74c3c;
            --bg: #f4f7f6;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }

        #game-container {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            width: 90%;
            max-width: 500px;
            text-align: center;
        }

        .header {
            border-bottom: 2px solid var(--primary);
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
        }

        .instruction-box {
            background: #ecf0f1;
            padding: 1rem;
            border-left: 5px solid var(--primary);
            margin-bottom: 1.5rem;
            font-weight: bold;
            font-size: 1.1rem;
        }

        .number-display {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary);
            margin: 1rem 0;
        }

        input[type="number"] {
            font-size: 1.5rem;
            padding: 0.5rem;
            width: 80%;
            border: 2px solid #bdc3c7;
            border-radius: 5px;
            margin-bottom: 1rem;
        }

        button {
            background: var(--accent);
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 1.1rem;
            border-radius: 5px;
            cursor: pointer;
            transition: transform 0.1s;
        }

        button:active { transform: scale(0.98); }

        .stats {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
            font-size: 0.9rem;
            color: #7f8c8d;
        }

        #feedback {
            height: 20px;
            font-weight: bold;
            margin-top: 10px;
        }
    </style>
</head>
<body>

<div id="game-container">
    <div class="header">
        <h2 style="margin:0;">Financial Auditor</h2>
        <small>Business Rounding Simulation</small>
    </div>

    <div id="instruction" class="instruction-box">
        Loading task...
    </div>

    <div id="number-to-round" class="number-display">
        $0.00
    </div>

    <input type="number" id="user-input" step="any" placeholder="Enter rounded amount">
    <br>
    <button onclick="checkAnswer()">Submit Audit</button>

    <div id="feedback"></div>

    <div class="stats">
        <span>Score: <span id="score">0</span></span>
        <span>Accuracy: <span id="accuracy">100</span>%</span>
    </div>
</div>

<script>
    let score = 0;
    let totalAttempts = 0;
    let currentGoal = {};
    
    const tasks = [
        { label: "Round to the nearest Cents (2 decimal places)", factor: 0.01, precision: 2 },
        { label: "Round to the nearest Whole Dollar (Taxes)", factor: 1, precision: 0 },
        { label: "Round to the nearest Hundred (Inventory)", factor: 100, precision: 0 },
        { label: "Round to the nearest Thousand (Annual Report)", factor: 1000, precision: 0 }
    ];

    function generateTask() {
        const task = tasks[Math.floor(Math.random() * tasks.length)];
        // Generate random business number (up to 100k)
        const rawNum = (Math.random() * 10000).toFixed(4); 
        
        currentGoal = {
            instruction: task.label,
            original: parseFloat(rawNum),
            // Standard rounding logic
            correct: Math.round(rawNum / task.factor) * task.factor
        };

        document.getElementById('instruction').innerText = currentGoal.instruction;
        document.getElementById('number-to-round').innerText = "$" + currentGoal.original.toLocaleString(undefined, {minimumFractionDigits: 2});
        document.getElementById('user-input').value = "";
        document.getElementById('user-input').focus();
    }

    function checkAnswer() {
        const userVal = parseFloat(document.getElementById('user-input').value);
        const feedback = document.getElementById('feedback');
        totalAttempts++;

        // We use a small epsilon for float comparison
        if (Math.abs(userVal - currentGoal.correct) < 0.001) {
            feedback.innerText = "✓ Correct Audit";
            feedback.style.color = "var(--accent)";
            score++;
        } else {
            feedback.innerText = "✘ Error: Correct value was " + currentGoal.correct;
            feedback.style.color = "var(--error)";
        }

        updateStats();
        setTimeout(generateTask, 1500);
    }

    function updateStats() {
        document.getElementById('score').innerText = score;
        const acc = Math.round((score / totalAttempts) * 100);
        document.getElementById('accuracy').innerText = acc;
    }

    // Handle "Enter" key
    document.getElementById('user-input').addEventListener('keypress', function (e) {
        if (e.key === 'Enter') checkAnswer();
    });

    // Start game
    generateTask();
</script>

</body>
</html>
