<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Math Challenge</title>
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #3498db;
            --bg: #f8f9fa;
        }

        body {
            font-family: 'Segoe UI', Tahoma, sans-serif;
            background-color: var(--bg);
            display: flex;
            justify-content: center;
            padding: 20px;
            margin: 0;
        }

        .container {
            max-width: 800px;
            width: 100%;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .scenario-card {
            background: #eef2f7;
            padding: 25px;
            border-left: 6px solid var(--accent);
            font-size: 1.3rem;
            margin-bottom: 30px;
            min-height: 100px;
            display: flex;
            align-items: center;
        }

        .button-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .formula-btn {
            padding: 15px;
            background: white;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: 0.2s;
        }

        .formula-btn:hover {
            border-color: var(--accent);
            background: #f0f7ff;
        }

        .correct { background-color: #27ae60 !important; color: white; border-color: #27ae60; }
        .wrong { background-color: #e74c3c !important; color: white; border-color: #e74c3c; }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .progress { color: #7f8c8d; font-weight: bold; }
        
        .hidden { display: none; }
        
        #result-screen { text-align: center; padding: 40px; }
        
        button#restart {
            padding: 10px 25px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
    </style>
</head>
<body>

<div class="container">
    <div id="game-screen">
        <div class="header">
            <span class="progress" id="progress">Question 1 of 8</span>
            <span id="score-box">Score: 0</span>
        </div>
        
        <div class="scenario-card" id="scenario-text">Loading...</div>

        <div class="button-grid" id="options">
            </div>
    </div>

    <div id="result-screen" class="hidden">
        <h2>Study Session Complete!</h2>
        <p id="final-stats"></p>
        <button id="restart" onclick="startGame()">Start New Random Set</button>
    </div>
</div>

<script>
    const rawData = [
        { type: "Simple Interest", templates: ["A payday loan for $#,### charges a flat interest fee of $### after two weeks.", "Calculate the interest on a $#,### personal loan at #% annual interest for # months with no compounding.", "A T-bill pays #% flat annual interest on a $##,### investment for one year.", "A pawn shop charges $### interest on a $#,### loan held for 30 days.", "You lend a friend $#,###; they pay you back the principal plus $### in simple interest.", "Find the interest earned on a #% simple interest savings certificate over # years on a $#,### deposit."] },
        { type: "Compound FV", templates: ["You put $#,### in a CD for # years at #% compounded monthly. What is the total?", "A $#,### investment grows at #% daily for # years. Find the future balance.", "Inflation is #% per year. If a car costs $##,### now, what will it cost in # years?", "A corporate bond grows from $#,### at a rate of #% compounded semi-annually for # years.", "A 'set it and forget it' fund of $#,### earns #% compounded quarterly for # years.", "If property values rise #% per year (compounded annually), what is a $###,### house worth in # years?"] },
        { type: "Compound PV", templates: ["How much is needed today to have $##,### in # years at #% compounded quarterly?", "Find the present value of $#,### due in # years discounted at #% compounded semi-annually.", "To have a $###,### nest egg in # years, what single lump sum must be saved now at #% monthly?", "A business wants $##,### for a new truck in # years. What amount should be set aside today at #%?", "What is the 'discounted value' of a $#,### debt due in # months at #% compounded daily?", "You want to give a $#,### gift in # years. What is the cost today if money earns #% annually?"] },
        { type: "Ordinary Annuity FV", templates: ["Deposit $### at the end of every month for # years at #% interest. Find the total.", "A sinking fund requires $#,### at the end of each year for # years at #% interest.", "You save $### from every bi-weekly paycheck (at the end) into an account earning #% for # years.", "A company sets aside $#,### at the end of each quarter to pay a debt in # years.", "Calculate the final balance of a 401k if $### is added at the end of each month for # years.", "You put $### into a college fund at the end of every month for # years at #% compounding."] },
        { type: "Annuity Due FV", templates: ["Start saving $### at the beginning of every month starting today for # years.", "Lease payments of $### are made at the start of each month into an interest-bearing account for # years.", "You deposit $### on the first day of every quarter for # years at #% interest.", "Beginning today, you invest $#,### annually for # years. What is the future value?", "A parent puts $### into an account on the 1st of every month for # years. Find the balance.", "To save for a wedding, you put $### in an account at the start of each month for # years."] },
        { type: "Ordinary Annuity PV", templates: ["You want to withdraw $#,### at the end of each month for # years of retirement. What total is needed now?", "A lottery payout pays $##,### at the end of each year for # years. What's the cash value today?", "A retirement pension offers $#,### per month for # years. Find the present value at #%.", "A court settlement pays $#,### at the end of every quarter for # years. What is the lump sum worth?", "How much must be in an account today to provide $### end-of-month stipends for # years?", "Calculate the current value of an annuity paying $#,### annually (at the end) for # years."] },
        { type: "Ordinary Annuity Pmt (FV)", templates: ["To save $##,### in # years, what end-of-month deposit is required at #%?", "Goal: $###,### for a house in # years. Find the required quarterly payment (at the end).", "How much must a firm save at the end of each year to reach $###,### in # years?", "To have $#,### for a vacation in # months, what monthly end-of-period payment is needed?", "A city needs $#,###,### for a new park in # years. What is the annual sinking fund payment?", "Find the periodic payment needed at the end of each month to accumulate $##,### in # years."] },
        { type: "Ordinary Annuity Pmt (PV)", templates: ["What is the monthly payment for a $##,### car loan at #% for # years?", "A mortgage of $###,### at #% for 30 years. Find the monthly payment.", "You finance a $#,### computer for # months at #%. Find the monthly installment.", "Calculate the semi-annual payment on a $##,### student loan over # years.", "A business borrows $##,### for equipment. Find the quarterly payment over # years.", "If you borrow $#,### today to be paid back over # years, find the end-of-month payment."] }
    ];

    let currentSet = [];
    let currentIndex = 0;
    let score = 0;

    // Fixed formula list for the buttons
    const formulaTypes = rawData.map(item => item.type);

    function startGame() {
        currentIndex = 0;
        score = 0;
        currentSet = [];
        
        // 1. Pick one random template from EACH category
        rawData.forEach(category => {
            let randomTemplate = category.templates[Math.floor(Math.random() * category.templates.length)];
            
            // 2. Fill in random numbers for the placeholders
            let filledScenario = randomTemplate
                .replace(/###,###/g, (Math.floor(Math.random() * 400) + 100) + ",000")
                .replace(/##,###/g, (Math.floor(Math.random() * 80) + 10) + ",000")
                .replace(/#,###/g, (Math.floor(Math.random() * 8) + 1) + "," + (Math.floor(Math.random() * 800) + 100))
                .replace(/###/g, (Math.floor(Math.random() * 8) + 1) * 50)
                .replace(/#/g, Math.floor(Math.random() * 8) + 2);

            currentSet.push({ text: filledScenario, correct: category.type });
        });

        // 3. Shuffle the 8 chosen questions
        currentSet.sort(() => Math.random() - 0.5);

        document.getElementById('game-screen').classList.remove('hidden');
        document.getElementById('result-screen').classList.add('hidden');
        showQuestion();
    }

    function showQuestion() {
        const q = currentSet[currentIndex];
        document.getElementById('scenario-text').innerText = q.text;
        document.getElementById('progress').innerText = `Question ${currentIndex + 1} of 8`;
        document.getElementById('score-box').innerText = `Score: ${score}`;
        
        const optionsDiv = document.getElementById('options');
        optionsDiv.innerHTML = '';
        
        formulaTypes.forEach(type => {
            const btn = document.createElement('button');
            btn.className = 'formula-btn';
            btn.innerText = type;
            btn.onclick = () => checkAnswer(type, btn);
            optionsDiv.appendChild(btn);
        });
    }

    function checkAnswer(choice, btn) {
        const correct = currentSet[currentIndex].correct;
        const allButtons = document.querySelectorAll('.formula-btn');
        allButtons.forEach(b => b.disabled = true); // Prevent double clicking

        if (choice === correct) {
            btn.classList.add('correct');
            score++;
        } else {
            btn.classList.add('wrong');
            // Highlight the right one too
            allButtons.forEach(b => {
                if(b.innerText === correct) b.classList.add('correct');
            });
        }

        setTimeout(() => {
            currentIndex++;
            if (currentIndex < currentSet.length) {
                showQuestion();
            } else {
                endGame();
            }
        }, 1500);
    }

    function endGame() {
        document.getElementById('game-screen').classList.add('hidden');
        document.getElementById('result-screen').classList.remove('hidden');
        document.getElementById('final-stats').innerText = `You correctly identified ${score} out of 8 formula types.`;
    }

    // Initialize on load
    startGame();
</script>

</body>
</html>
